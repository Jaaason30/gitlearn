<view class="container">

<!-- 顶部自定义导航栏 -->
<view class="top-bar" style="padding-top:{{statusBarHeight}}px;height:{{statusBarHeight + 44}}px;">
  <view class="icon-btn" bindtap="onMenuTap">
    <text class="icon-emoji">☰</text>
  </view>

  <view class="top-tabs">
    <block wx:for="{{topTabs}}" wx:key="*this">
      <view class="tab-touch" bindtap="onTopTabTap" data-key="{{item}}">
        <text class="tab-text {{activeTopTab === item ? 'tab-active' : ''}}">{{item}}</text>
      </view>
    </block>
  </view>

  <view class="icon-btn" bindtap="onSearchTap">
    <text class="icon-emoji">🔍</text>
  </view>
</view>

<!-- 主内容：下拉刷新 + 上拉加载 -->
<scroll-view
  class="content"
  scroll-y="true"
  refresher-enabled="true"
  refresher-triggered="{{refreshing}}"
  bindrefresherrefresh="onPullDownRefresh"
  bindscrolltolower="onReachBottom"
  lower-threshold="100"
  style="padding-bottom:112rpx;"
>
  <!-- Banner 轮播 -->
  <swiper
    class="banner"
    indicator-dots="true"
    indicator-color="#ccc"
    indicator-active-color="#d81e06"
    autoplay="true"
    interval="3000"
    duration="500"
  >
    <block wx:for="{{bannerList}}" wx:key="index">
      <swiper-item>
        <image
          src="{{item.src}}"
          class="banner-image"
          mode="aspectFill"
          binderror="onBannerError"
          data-index="{{index}}"
        />
      </swiper-item>
    </block>
  </swiper>

  <!-- 帖子两列 -->
  <view class="list-content">
    <block wx:for="{{posts}}" wx:key="uuid" wx:for-index="idx">
      <view class="card {{(idx + 1) % 2 === 0 ? 'card-even' : ''}}">
        <image
          src="{{item.imageUrl}}"
          class="card-image"
          mode="aspectFill"
          binderror="onPostImageError"
          data-index="{{idx}}"
        />
        <text class="card-title">{{item.title}}</text>
        <view class="card-footer">
          <view class="author-container">
            <image
              src="{{item.authorAvatar}}"
              class="author-avatar"
              mode="aspectFill"
              binderror="onAvatarError"
              data-index="{{idx}}"
            />
            <text class="author">{{item.authorName}}</text>
          </view>
          <view class="likes-row">
            <text class="like-icon">👍</text>
            <text class="likes-text">{{item.likes}}</text>
          </view>
        </view>
      </view>
    </block>
  </view>
</scroll-view>

<!-- 底部导航（四个按钮 + 顶部小圆点高亮） -->
<view class="bottom-bar">
  <block wx:for="{{bottomTabs}}" wx:key="key">
    <view class="bottom-item-container" bindtap="onBottomTabTap" data-key="{{item.key}}">
      <view wx:if="{{activeBottom === item.key}}" class="bottom-dot"></view>
      <view class="bottom-item {{activeBottom === item.key ? 'bottom-item-active' : ''}}">
        <text class="bottom-icon" style="color:{{activeBottom === item.key ? '#d81e06' : '#888'}}">{{item.icon}}</text>
        <text class="bottom-label {{activeBottom === item.key ? 'bottom-label-active' : ''}}">{{item.label}}</text>
      </view>
    </view>
  </block>
</view>
</view>
